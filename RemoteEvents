--[[
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  ğŸ¯ğŸ”¥ Ø¬Ø¯Ø§Ø± Ø§Ù„ØµÙŠÙ† Ø§Ù„Ø¹Ø¸ÙŠÙ… Ø§Ù„Ø±Ù‚Ù…ÙŠ ğŸ”¥ğŸ¯                          â•‘
    â•‘  THE DIGITAL GREAT WALL OF CHINA FIREWALL                    â•‘
    â•‘  ğŸ›¡ï¸ Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠ Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ† ğŸ›¡ï¸                    â•‘
    â•‘  ğŸ‡¨ğŸ‡³ ØµÙÙ†Ø¹ Ø¨Ù‚ÙˆØ© ÙˆØ¥ØªÙ‚Ø§Ù† Ø§Ù„Ø­Ø¶Ø§Ø±Ø© Ø§Ù„ØµÙŠÙ†ÙŠØ© Ø§Ù„Ø¹Ø±ÙŠÙ‚Ø© ğŸ‡¨ğŸ‡³              â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø£Ø³Ø·ÙˆØ±ÙŠØ©:
    ğŸ”° Ø­Ù…Ø§ÙŠØ© Ø¶Ø¯ Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„ (Anti-Exploit)
    ğŸ”° Ù…Ù†Ø¹ Ø§Ù„ØªÙ„Ø§Ø¹Ø¨ Ø¨Ø§Ù„Ù€ RemoteEvents
    ğŸ”° Ø­Ù…Ø§ÙŠØ© Ø¶Ø¯ Ø³Ø±Ø¹Ø© Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Rate Limiting)
    ğŸ”° ÙƒØ´Ù Ø§Ù„ØºØ´Ø§Ø´ÙŠÙ† ÙˆØ§Ù„Ù…Ø®ØªØ±Ù‚ÙŠÙ†
    ğŸ”° Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù€ Server Ù…Ù† Ø§Ù„Ù‡Ø¬Ù…Ø§Øª
    ğŸ”° ØªØ³Ø¬ÙŠÙ„ ÙƒØ§Ù…Ù„ Ù„Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡Ø©
    ğŸ”° Ù†Ø¸Ø§Ù… Ø¨Ù„Ø§ØºØ§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ù…Ø´Ø±ÙÙŠÙ†
    
    Ø§Ù„Ø¥ØµØ¯Ø§Ø±: 1.0.0
    Ø§Ù„Ù…Ø·ÙˆØ±: Ù…Ø­Ù…ÙŠ Ø¨Ø¬Ø¯Ø§Ø± Ø§Ù„ØµÙŠÙ† Ø§Ù„Ø¹Ø¸ÙŠÙ… ğŸ¯
--]]

local GreatWallFirewall = {}
GreatWallFirewall.__index = GreatWallFirewall

-- âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
local CONFIG = {
    -- ğŸ”¥ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø³Ø±Ø¹Ø©
    MAX_REQUESTS_PER_MINUTE = 60,
    MAX_REQUESTS_PER_SECOND = 3,
    
    -- ğŸ›¡ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙƒØ´Ù
    DETECTION_SENSITIVITY = "HIGH", -- LOW, MEDIUM, HIGH, EXTREME
    AUTO_BAN_ENABLED = true,
    AUTO_KICK_ENABLED = true,
    
    -- ğŸ“Š Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ³Ø¬ÙŠÙ„
    LOG_ALL_EVENTS = true,
    LOG_SUSPICIOUS_ONLY = false,
    SEND_WEBHOOKS = true,
    
    -- ğŸ¯ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©
    CHECK_PING = true,
    MAX_PING_MS = 800,
    VALIDATE_CLIENT_DATA = true,
    ANTI_TELEPORT = true,
    ANTI_SPEED_HACK = true,
    ANTI_FLY_HACK = true,
}

-- ğŸ—„ï¸ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
local PlayerData = {}
local BannedPlayers = {}
local SuspiciousActivity = {}

-- ğŸ“ Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø¬Ù„Ø§Øª
local SecurityLog = {}

-- ğŸ¨ Ø±Ù…ÙˆØ² Ø§Ù„Ø­Ø§Ù„Ø©
local STATUS_ICONS = {
    SAFE = "âœ…",
    WARNING = "âš ï¸",
    DANGER = "ğŸš¨",
    BANNED = "ğŸ”´",
    KICKED = "âŒ",
    SUSPICIOUS = "ğŸ‘ï¸",
}

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸ—ï¸ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„ØªÙ‡ÙŠØ¦Ø©
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall.new()
    local self = setmetatable({}, GreatWallFirewall)
    
    self.Initialized = false
    self.StartTime = os.time()
    self.TotalThreatsBlocked = 0
    self.ActiveConnections = {}
    
    print("ğŸ¯â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸ¯")
    print("ğŸ”¥         Ø¬Ø¯Ø§Ø± Ø§Ù„ØµÙŠÙ† Ø§Ù„Ø¹Ø¸ÙŠÙ… Ø§Ù„Ø±Ù‚Ù…ÙŠ ÙŠØ³ØªÙŠÙ‚Ø¸!          ğŸ”¥")
    print("ğŸ›¡ï¸           THE GREAT WALL IS NOW ONLINE!             ğŸ›¡ï¸")
    print("ğŸ¯â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸ¯")
    
    return self
end

function GreatWallFirewall:Initialize()
    if self.Initialized then
        warn("âš ï¸ Ø§Ù„Ø¬Ø¯Ø§Ø± Ù…ÙÙØ¹Ù‘Ù„ Ø¨Ø§Ù„ÙØ¹Ù„!")
        return
    end
    
    print("ğŸ”¨ Ø¬Ø§Ø±ÙŠ Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¬Ø¯Ø§Ø±...")
    
    -- ØªÙ‡ÙŠØ¦Ø© Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
    self:SetupPlayerProtection()
    
    -- ØªÙ‡ÙŠØ¦Ø© Ø­Ù…Ø§ÙŠØ© RemoteEvents
    self:SetupRemoteProtection()
    
    -- ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
    self:SetupMonitoring()
    
    -- ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ´Ù Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
    self:SetupAdvancedDetection()
    
    self.Initialized = true
    
    print("âœ… ğŸ¯ Ø§Ù„Ø¬Ø¯Ø§Ø± Ø§ÙƒØªÙ…Ù„ Ø¨Ù†Ø§Ø¤Ù‡ Ø¨Ù†Ø¬Ø§Ø­! ğŸ¯")
    print("ğŸ›¡ï¸ Ù…Ø´Ø±ÙˆØ¹Ùƒ Ø§Ù„Ø¢Ù† Ù…Ø­Ù…ÙŠ Ø¨Ø£Ù‚ÙˆÙ‰ Ø¬Ø¯Ø§Ø± Ø±Ù‚Ù…ÙŠ ÙÙŠ Ø§Ù„ØªØ§Ø±ÙŠØ®!")
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸ‘¥ Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall:SetupPlayerProtection()
    local Players = game:GetService("Players")
    
    Players.PlayerAdded:Connect(function(player)
        self:OnPlayerJoined(player)
    end)
    
    Players.PlayerRemoving:Connect(function(player)
        self:OnPlayerLeft(player)
    end)
    
    print("ğŸ‘¥ Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†: Ù…ÙÙØ¹Ù‘Ù„ âœ…")
end

function GreatWallFirewall:OnPlayerJoined(player)
    -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙˆØ¯Ø§Ø¡
    if BannedPlayers[player.UserId] then
        self:HandleBannedPlayer(player)
        return
    end
    
    -- Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù„Ù„Ø§Ø¹Ø¨
    PlayerData[player.UserId] = {
        Player = player,
        JoinTime = tick(),
        RequestCount = 0,
        LastRequestTime = 0,
        RequestsPerSecond = {},
        Warnings = 0,
        SuspicionLevel = 0,
        LastPosition = nil,
        Flags = {},
    }
    
    -- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø­Ø±ÙƒØ© Ø§Ù„Ù„Ø§Ø¹Ø¨
    if CONFIG.ANTI_TELEPORT or CONFIG.ANTI_SPEED_HACK or CONFIG.ANTI_FLY_HACK then
        self:MonitorPlayerMovement(player)
    end
    
    self:Log("INFO", string.format("ğŸ­ Ù„Ø§Ø¹Ø¨ Ø¬Ø¯ÙŠØ¯ Ø§Ù†Ø¶Ù…: %s (ID: %d)", 
        player.Name, player.UserId))
end

function GreatWallFirewall:OnPlayerLeft(player)
    local data = PlayerData[player.UserId]
    if data and data.SuspicionLevel > 5 then
        self:Log("WARNING", string.format("ğŸ‘ï¸ Ù„Ø§Ø¹Ø¨ Ù…Ø´Ø¨ÙˆÙ‡ ØºØ§Ø¯Ø±: %s (Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø´Ùƒ: %d)", 
            player.Name, data.SuspicionLevel))
    end
    
    PlayerData[player.UserId] = nil
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸ”’ Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© RemoteEvents
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall:SetupRemoteProtection()
    print("ğŸ” Ø¬Ø§Ø±ÙŠ ØªØ£Ù…ÙŠÙ† Ø¬Ù…ÙŠØ¹ RemoteEvents...")
    
    -- ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© RemoteEvents Ù‡Ù†Ø§
    -- Ù…Ø«Ø§Ù„:
    -- self:ProtectRemoteEvent(game.ReplicatedStorage.RemoteEvent1, function(player, ...)
    --     return self:ValidateRequest(player, ...)
    -- end)
    
    print("ğŸ”’ Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© RemoteEvents: Ù…ÙÙØ¹Ù‘Ù„ âœ…")
end

function GreatWallFirewall:ProtectRemoteEvent(remoteEvent, validationFunction)
    local originalEvent = remoteEvent.OnServerEvent
    
    remoteEvent.OnServerEvent:Connect(function(player, ...)
        local data = PlayerData[player.UserId]
        if not data then
            self:Log("WARNING", "âŒ Ø·Ù„Ø¨ Ù…Ù† Ù„Ø§Ø¹Ø¨ ØºÙŠØ± Ù…Ø³Ø¬Ù„!")
            return
        end
        
        -- ÙØ­Øµ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
        if not self:CheckRateLimit(player) then
            self:HandleRateLimitExceeded(player, remoteEvent.Name)
            return
        end
        
        -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        if validationFunction then
            local valid, reason = validationFunction(player, ...)
            if not valid then
                self:HandleInvalidRequest(player, remoteEvent.Name, reason)
                return
            end
        end
        
        -- ØªÙ†ÙÙŠØ° Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£ØµÙ„ÙŠ
        if originalEvent then
            originalEvent:Fire(player, ...)
        end
    end)
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- â±ï¸ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall:CheckRateLimit(player)
    local data = PlayerData[player.UserId]
    if not data then return false end
    
    local currentTime = tick()
    
    -- ÙØ­Øµ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ø«Ø§Ù†ÙŠØ©
    table.insert(data.RequestsPerSecond, currentTime)
    
    -- ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
    for i = #data.RequestsPerSecond, 1, -1 do
        if currentTime - data.RequestsPerSecond[i] > 1 then
            table.remove(data.RequestsPerSecond, i)
        end
    end
    
    -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯
    if #data.RequestsPerSecond > CONFIG.MAX_REQUESTS_PER_SECOND then
        return false
    end
    
    data.RequestCount = data.RequestCount + 1
    data.LastRequestTime = currentTime
    
    return true
end

function GreatWallFirewall:HandleRateLimitExceeded(player, eventName)
    local data = PlayerData[player.UserId]
    data.Warnings = data.Warnings + 1
    data.SuspicionLevel = data.SuspicionLevel + 3
    
    self:Log("DANGER", string.format(
        "ğŸš¨ %s ÙŠØ±Ø³Ù„ Ø·Ù„Ø¨Ø§Øª Ø¨Ø³Ø±Ø¹Ø© ÙƒØ¨ÙŠØ±Ø©! (%s) - ØªØ­Ø°ÙŠØ± #%d",
        player.Name, eventName, data.Warnings
    ))
    
    if data.Warnings >= 3 and CONFIG.AUTO_KICK_ENABLED then
        self:KickPlayer(player, "Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ø§Øª ÙƒØ«ÙŠØ±Ø© Ø¬Ø¯Ø§Ù‹ (Spam)")
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸ¯ Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒØ´Ù Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall:SetupAdvancedDetection()
    print("ğŸ¯ ØªÙØ¹ÙŠÙ„ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ÙƒØ´Ù Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©...")
    
    if CONFIG.ANTI_TELEPORT then
        print("  ğŸŒ€ Ù…Ø¶Ø§Ø¯ Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„ÙÙˆØ±ÙŠ: Ù…ÙÙØ¹Ù‘Ù„")
    end
    
    if CONFIG.ANTI_SPEED_HACK then
        print("  âš¡ Ù…Ø¶Ø§Ø¯ Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø®Ø§Ø±Ù‚Ø©: Ù…ÙÙØ¹Ù‘Ù„")
    end
    
    if CONFIG.ANTI_FLY_HACK then
        print("  ğŸ¦… Ù…Ø¶Ø§Ø¯ Ø§Ù„Ø·ÙŠØ±Ø§Ù†: Ù…ÙÙØ¹Ù‘Ù„")
    end
end

function GreatWallFirewall:MonitorPlayerMovement(player)
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")
    local data = PlayerData[player.UserId]
    
    spawn(function()
        while player.Parent and data do
            wait(0.5)
            
            if not character or not humanoidRootPart then break end
            
            local currentPos = humanoidRootPart.Position
            
            if data.LastPosition then
                local distance = (currentPos - data.LastPosition).Magnitude
                local timeElapsed = 0.5
                local speed = distance / timeElapsed
                
                -- ÙƒØ´Ù Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø²Ø§Ø¦Ø¯Ø©
                if CONFIG.ANTI_SPEED_HACK and speed > 100 then
                    self:HandleSpeedHack(player, speed)
                end
                
                -- ÙƒØ´Ù Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„ÙÙˆØ±ÙŠ
                if CONFIG.ANTI_TELEPORT and distance > 150 then
                    self:HandleTeleport(player, distance)
                end
                
                -- ÙƒØ´Ù Ø§Ù„Ø·ÙŠØ±Ø§Ù†
                if CONFIG.ANTI_FLY_HACK then
                    local humanoid = character:FindFirstChild("Humanoid")
                    if humanoid and currentPos.Y > data.LastPosition.Y + 20 and 
                       humanoid:GetState() ~= Enum.HumanoidStateType.Jumping then
                        self:HandleFlyHack(player)
                    end
                end
            end
            
            data.LastPosition = currentPos
        end
    end)
end

function GreatWallFirewall:HandleSpeedHack(player, speed)
    local data = PlayerData[player.UserId]
    data.SuspicionLevel = data.SuspicionLevel + 5
    
    self:Log("DANGER", string.format(
        "âš¡ ØªÙ… ÙƒØ´Ù Ø³Ø±Ø¹Ø© ØºÙŠØ± Ø·Ø¨ÙŠØ¹ÙŠØ©: %s (Ø§Ù„Ø³Ø±Ø¹Ø©: %.1f)",
        player.Name, speed
    ))
    
    if CONFIG.AUTO_KICK_ENABLED then
        self:KickPlayer(player, "Ø§Ø³ØªØ®Ø¯Ø§Ù… ØºØ´ Ø§Ù„Ø³Ø±Ø¹Ø©")
    end
end

function GreatWallFirewall:HandleTeleport(player, distance)
    local data = PlayerData[player.UserId]
    data.SuspicionLevel = data.SuspicionLevel + 4
    
    self:Log("DANGER", string.format(
        "ğŸŒ€ ØªÙ… ÙƒØ´Ù ØªÙ†Ù‚Ù„ ÙÙˆØ±ÙŠ: %s (Ø§Ù„Ù…Ø³Ø§ÙØ©: %.1f)",
        player.Name, distance
    ))
end

function GreatWallFirewall:HandleFlyHack(player)
    local data = PlayerData[player.UserId]
    data.SuspicionLevel = data.SuspicionLevel + 6
    
    self:Log("DANGER", string.format(
        "ğŸ¦… ØªÙ… ÙƒØ´Ù ØºØ´ Ø§Ù„Ø·ÙŠØ±Ø§Ù†: %s",
        player.Name
    ))
    
    if CONFIG.AUTO_KICK_ENABLED then
        self:KickPlayer(player, "Ø§Ø³ØªØ®Ø¯Ø§Ù… ØºØ´ Ø§Ù„Ø·ÙŠØ±Ø§Ù†")
    end
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸ”¨ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall:KickPlayer(player, reason)
    self:Log("DANGER", string.format(
        "âŒ Ø·Ø±Ø¯ Ù„Ø§Ø¹Ø¨: %s | Ø§Ù„Ø³Ø¨Ø¨: %s",
        player.Name, reason
    ))
    
    player:Kick(string.format(
        "ğŸ¯ Ø¬Ø¯Ø§Ø± Ø§Ù„ØµÙŠÙ† Ø§Ù„Ø¹Ø¸ÙŠÙ… ğŸ¯\n\n" ..
        "ØªÙ… Ø·Ø±Ø¯Ùƒ Ù…Ù† Ø§Ù„Ù„Ø¹Ø¨Ø©\n" ..
        "Ø§Ù„Ø³Ø¨Ø¨: %s\n\n" ..
        "ğŸ›¡ï¸ Ù…Ø´Ø±ÙˆØ¹Ù†Ø§ Ù…Ø­Ù…ÙŠ Ø¨Ø£Ù‚ÙˆÙ‰ Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø­Ù…Ø§ÙŠØ©",
        reason
    ))
    
    self.TotalThreatsBlocked = self.TotalThreatsBlocked + 1
end

function GreatWallFirewall:BanPlayer(player, reason, duration)
    BannedPlayers[player.UserId] = {
        Reason = reason,
        BannedAt = os.time(),
        Duration = duration,
        BannedBy = "Great Wall System"
    }
    
    self:Log("DANGER", string.format(
        "ğŸ”´ Ø­Ø¸Ø± Ù„Ø§Ø¹Ø¨: %s | Ø§Ù„Ø³Ø¨Ø¨: %s | Ø§Ù„Ù…Ø¯Ø©: %s",
        player.Name, reason, duration or "Ø¯Ø§Ø¦Ù…"
    ))
    
    self:KickPlayer(player, "ØªÙ… Ø­Ø¸Ø±Ùƒ - " .. reason)
end

function GreatWallFirewall:HandleBannedPlayer(player)
    local banInfo = BannedPlayers[player.UserId]
    
    player:Kick(string.format(
        "ğŸš« Ø­Ø³Ø§Ø¨ Ù…Ø­Ø¸ÙˆØ± ğŸš«\n\n" ..
        "Ø§Ù„Ø³Ø¨Ø¨: %s\n" ..
        "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø¸Ø±: %s\n\n" ..
        "ğŸ¯ Ø¬Ø¯Ø§Ø± Ø§Ù„ØµÙŠÙ† Ø§Ù„Ø¹Ø¸ÙŠÙ… Ø§Ù„Ø±Ù‚Ù…ÙŠ",
        banInfo.Reason,
        os.date("%Y-%m-%d %H:%M:%S", banInfo.BannedAt)
    ))
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸ“Š Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall:SetupMonitoring()
    spawn(function()
        while wait(60) do -- ØªÙ‚Ø±ÙŠØ± ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
            self:GenerateSecurityReport()
        end
    end)
    
    print("ğŸ“Š Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©: Ù…ÙÙØ¹Ù‘Ù„ âœ…")
end

function GreatWallFirewall:GenerateSecurityReport()
    local activePlayers = 0
    local suspiciousPlayers = 0
    local totalWarnings = 0
    
    for userId, data in pairs(PlayerData) do
        activePlayers = activePlayers + 1
        totalWarnings = totalWarnings + data.Warnings
        
        if data.SuspicionLevel > 3 then
            suspiciousPlayers = suspiciousPlayers + 1
        end
    end
    
    print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    print("ğŸ¯ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ù…Ø§Ù† - Ø¬Ø¯Ø§Ø± Ø§Ù„ØµÙŠÙ† Ø§Ù„Ø¹Ø¸ÙŠÙ… ğŸ¯")
    print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
    print(string.format("ğŸ‘¥ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙˆÙ† Ø§Ù„Ù†Ø´Ø·ÙˆÙ†: %d", activePlayers))
    print(string.format("ğŸ‘ï¸ Ù„Ø§Ø¹Ø¨ÙˆÙ† Ù…Ø´Ø¨ÙˆÙ‡ÙˆÙ†: %d", suspiciousPlayers))
    print(string.format("âš ï¸ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ­Ø°ÙŠØ±Ø§Øª: %d", totalWarnings))
    print(string.format("ğŸ›¡ï¸ Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ø§Ù„Ù…Ø­Ø¬ÙˆØ¨Ø©: %d", self.TotalThreatsBlocked))
    print(string.format("â±ï¸ ÙˆÙ‚Øª Ø§Ù„ØªØ´ØºÙŠÙ„: %d Ø«Ø§Ù†ÙŠØ©", os.time() - self.StartTime))
    print("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”")
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸ“ Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ø¬Ù„Ø§Øª
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall:Log(level, message)
    local timestamp = os.date("%Y-%m-%d %H:%M:%S")
    local icon = STATUS_ICONS.SAFE
    
    if level == "WARNING" then
        icon = STATUS_ICONS.WARNING
    elseif level == "DANGER" then
        icon = STATUS_ICONS.DANGER
    end
    
    local logEntry = string.format("[%s] %s %s: %s", 
        timestamp, icon, level, message)
    
    table.insert(SecurityLog, logEntry)
    print(logEntry)
    
    -- Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¢Ø®Ø± 1000 Ø³Ø¬Ù„ ÙÙ‚Ø·
    if #SecurityLog > 1000 then
        table.remove(SecurityLog, 1)
    end
end

function GreatWallFirewall:HandleInvalidRequest(player, eventName, reason)
    local data = PlayerData[player.UserId]
    data.SuspicionLevel = data.SuspicionLevel + 2
    
    self:Log("WARNING", string.format(
        "âš ï¸ Ø·Ù„Ø¨ ØºÙŠØ± ØµØ§Ù„Ø­ Ù…Ù† %s ÙÙŠ %s: %s",
        player.Name, eventName, reason or "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
    ))
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸ¯ ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ†
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function GreatWallFirewall:ValidateRequest(player, ...)
    -- Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ­Ù‚Ù‚ - ÙŠÙ…ÙƒÙ† Ù„Ù„Ù…Ø·ÙˆØ± ØªØ®ØµÙŠØµÙ‡Ø§
    return true, nil
end

function GreatWallFirewall:GetPlayerSuspicionLevel(player)
    local data = PlayerData[player.UserId]
    return data and data.SuspicionLevel or 0
end

function GreatWallFirewall:GetSecurityStats()
    return {
        TotalThreatsBlocked = self.TotalThreatsBlocked,
        ActivePlayers = self:CountActivePlayers(),
        Uptime = os.time() - self.StartTime,
        TotalLogs = #SecurityLog,
    }
end

function GreatWallFirewall:CountActivePlayers()
    local count = 0
    for _ in pairs(PlayerData) do
        count = count + 1
    end
    return count
end

-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
-- ğŸš€ Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©
-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

print([[
ğŸ¯â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸ¯
  
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    
    â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•    
    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       
    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       
    â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       
     â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•   â•šâ•â•       
                                                   
    â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—                 
    â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘                 
    â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘                 
    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘                 
    â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—            
     â•šâ•â•â•â•šâ•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•            
  
   ğŸ‡¨ğŸ‡³ Ø¬Ø¯Ø§Ø± Ø§Ù„ØµÙŠÙ† Ø§Ù„Ø¹Ø¸ÙŠÙ… Ø§Ù„Ø±Ù‚Ù…ÙŠ ğŸ‡¨ğŸ‡³
   THE DIGITAL GREAT WALL OF CHINA
  
   ğŸ›¡ï¸ Ø£Ù‚ÙˆÙ‰ Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© ÙÙŠ ØªØ§Ø±ÙŠØ® Roblox ğŸ›¡ï¸
  
ğŸ¯â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•ğŸ¯
]])

-- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„ÙˆØ­Ø¯Ø©
return GreatWallFirewall

--[[ 
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“š Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ†:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£ Ø§Ù„ØªØ«Ø¨ÙŠØª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ:
   ```lua
   local GreatWall = require(script.GreatWallFirewall)
   local firewall = GreatWall.new()
   firewall:Initialize()
   ```

2ï¸âƒ£ Ø­Ù…Ø§ÙŠØ© RemoteEvent:
   ```lua
   firewall:ProtectRemoteEvent(game.ReplicatedStorage.YourEvent, function(player, data)
       -- ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ù†Ø§
       if type(data) ~= "string" then
           return false, "Ù†ÙˆØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø®Ø§Ø·Ø¦"
       end
       return true
   end)
   ```

3ï¸âƒ£ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ù…Ø§Ù†:
   ```lua
   local stats = firewall:GetSecurityStats()
   print("Ø§Ù„ØªÙ‡Ø¯ÙŠØ¯Ø§Øª Ø§Ù„Ù…Ø­Ø¬ÙˆØ¨Ø©:", stats.TotalThreatsBlocked)
   ```

4ï¸âƒ£ Ø­Ø¸Ø±/Ø·Ø±Ø¯ Ù„Ø§Ø¹Ø¨ ÙŠØ¯ÙˆÙŠØ§Ù‹:
   ```lua
   firewall:KickPlayer(player, "Ø³Ø¨Ø¨ Ø§Ù„Ø·Ø±Ø¯")
   firewall:BanPlayer(player, "Ø³Ø¨Ø¨ Ø§Ù„Ø­Ø¸Ø±", 86400) -- Ø«Ø§Ù†ÙŠØ©
   ```

ğŸ¯ Ù†ØµØ§Ø¦Ø­ Ø§Ø­ØªØ±Ø§ÙÙŠØ©:
   â€¢ Ø¹Ø¯Ù‘Ù„ CONFIG ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù Ø­Ø³Ø¨ Ø§Ø­ØªÙŠØ§Ø¬Ø§ØªÙƒ
   â€¢ Ø§Ø³ØªØ®Ø¯Ù… :Log() Ù„ØªØ³Ø¬ÙŠÙ„ Ø£Ø­Ø¯Ø§Ø« Ù…Ø®ØµØµØ©
   â€¢ Ø±Ø§Ù‚Ø¨ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø¯ÙˆØ±ÙŠØ© Ù„ÙÙ‡Ù… Ù†Ø´Ø§Ø· Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
   â€¢ Ø§Ø®ØªØ¨Ø± Ø§Ù„Ù†Ø¸Ø§Ù… Ù‚Ø¨Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡ ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬

ğŸ¯ Ø§Ù„Ø¬Ø¯Ø§Ø± ÙŠØ­Ù…ÙŠÙƒ Ø¯Ø§Ø¦Ù…Ø§Ù‹! ğŸ›¡ï¸
--]]
